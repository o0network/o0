<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
    <meta name="theme-color" content="#000000" />
    <title>Telegram Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    <script type="module">
      // This will include the Expo React Native Web bundle
      import '../index.js';

      // Check if we're in Telegram
      if (window.Telegram) {
        console.log('Running inside Telegram WebApp');
        // You can access Telegram features via window.Telegram.WebApp
      } else {
        console.warn('Not running inside Telegram WebApp');

        // For development only: Mock Telegram environment
        if (process.env.NODE_ENV === 'development') {
          console.log('Mocking Telegram environment for development');
          window.Telegram = {
            WebApp: {
              initDataUnsafe: {
                user: {
                  id: 12345,
                  first_name: 'Test',
                  last_name: 'User',
                  username: 'testuser'
                }
              },
              colorScheme: 'dark',
              themeParams: {
                bg_color: '#17212b',
                text_color: '#ffffff',
                hint_color: '#708499',
                link_color: '#6ab3f3',
                button_color: '#5288c1',
                button_text_color: '#ffffff'
              },
              MainButton: {
                setText: (text) => console.log(`MainButton.setText: ${text}`),
                show: () => console.log('MainButton.show'),
                hide: () => console.log('MainButton.hide'),
                setParams: (params) => console.log('MainButton.setParams', params),
                onClick: (fn) => console.log('MainButton.onClick registered')
              },
              HapticFeedback: {
                impactOccurred: (style) => console.log(`HapticFeedback.impactOccurred: ${style}`),
                notificationOccurred: (type) => console.log(`HapticFeedback.notificationOccurred: ${type}`),
                selectionChanged: () => console.log('HapticFeedback.selectionChanged')
              },
              isExpanded: true,
              viewportHeight: window.innerHeight,
              viewportStableHeight: window.innerHeight,
              showPopup: (params) => {
                console.log('showPopup', params);
                return Promise.resolve({ button_id: params.buttons?.[0]?.id || 'ok' });
              },
              close: () => console.log('WebApp.close')
            }
          };
        }
      }
    </script>
  </body>
</html>